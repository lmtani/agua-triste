- name: Teste do workflow para detecção de covid
  command: miniwdl run -i tests/inputs.json detectar-covid.wdl
  files:
    - path: "_LAST/out/covid_presence/covid_presence.boolean"
      contains:
        - "true"
    - path: "_LAST/out/coverage/coverage.float"
      contains:
        - "0.310"

- name: Teste da tarefa ArticGuppyplex. Checa se o FASTQ gerado bate com o esperado.
  command: miniwdl run --task ArticGuppyplex -i tests/guppylex.inputs.json detectar-covid.wdl
  files:
    - path: "_LAST/out/fastq/guppyplexed.fastq.gz"
      md5sum: aaa

- name: Teste da tarefa CalculateCoverages. Verifica a cobertura na região SRY do cromossomo Y.
  command: miniwdl run --task CalculateCoverages -i tests/calculate-coverage.inputs.json predicao-de-sexo.wdl
  files:
    - path: "_LAST/out/coverages/coverages.txt"
      contains:
        - "CXT070-001.sry\tchrY\t2786854\t2787741\tSRY\t821\t739\t716\t688"
        - "KAB133-001.sry\tchrY\t2786854\t2787741\tSRY\t803\t724\t697\t677"
        - "NQB080-001.sry\tchrY\t2786854\t2787741\tSRY\t747\t709\t678\t649"
        - "OZX502-001.sry\tchrY\t2786854\t2787741\tSRY\t0\t0\t0\t0"
        - "UQE098-001.sry\tchrY\t2786854\t2787741\tSRY\t0\t0\t0\t0"
